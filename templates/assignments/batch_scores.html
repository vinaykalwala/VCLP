{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
    <h2>Batch Scores</h2>

    <!-- Batch Selection Form -->
    <form method="get" class="mb-4">
        <div class="row g-2 align-items-center">
            <div class="col-auto">
                <label for="batch_id" class="col-form-label">Select Batch:</label>
            </div>
            <div class="col-auto">
                <select name="batch_id" id="batch_id" class="form-select" required>
    <option value="">-- Select Batch --</option>
    {% for batch in batches %}
        <option value="{{ batch.id }}" {% if selected_batch and batch.id == selected_batch.id %}selected{% endif %}>
            {{ batch.name }}
        </option>
    {% endfor %}
</select>

            </div>
            <div class="col-auto">
                <button type="submit" class="btn btn-primary">Show Scores</button>
            </div>
        </div>
    </form>

    {% if selected_batch %}
        <h3>Scores for Batch: {{ selected_batch.name }}</h3>
        <table class="table table-striped table-bordered align-middle">
            <thead class="table-dark">
                <tr>
                    <th>Intern</th>
                    <th>Total Assignments</th>
                    <th>Submitted</th>
                    <th>Graded</th>
                    <th>Total Score</th>
                    <th>Average Score</th>
                    <th>Completion %</th>
                </tr>
            </thead>
            <tbody>
                {% for row in scoreboard %}
                <tr>
                    <td>{{ row.intern.user.get_full_name|default:row.intern.unique_id }}</td>
                    <td>{{ row.total_assignments }}</td>
                    <td>{{ row.submitted_count }}</td>
                    <td>{{ row.graded_count }}</td>
                    <td>{{ row.total_score }}</td>
                    <td>{{ row.average_score }}</td>
                    <td>{{ row.completion_rate }}%</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="7" class="text-center">No interns or assignment data found for this batch.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}
</div>
{% endblock %}
