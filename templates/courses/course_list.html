{% extends 'login_base.html' %}
{% block title %}Courses{% endblock %}
{% block content %}
{% load static %}
<style>
:root {
  --primary: #5932EA;         /* Blue accent */
  --primary-dark: #1D4ED8;    /* Darker blue for hover */
  --primary-light: #60A5FA;   /* Light blue glow */
  --bg: #ffffff;               /* White background */
  --bg-light: #F3F4F6;         /* Light gray */
  --text-light: #111827;       /* Dark text */
  --text-muted: #6B7280;       /* Muted gray */
  --shadow: 0 4px 12px rgba(0,0,0,0.08);
  --shadow-lg: 0 8px 25px rgba(0,0,0,0.12);
  --transition: all 0.3s ease;
  --border-radius: 16px;
}

/* Page Layout */
.course-page {
  margin-left: 260px;
  padding: 30px; 
  background: linear-gradient(135deg, var(--bg-light) 0%, #f9fafb 100%);
  font-family: 'Inter', 'Helvetica Neue', Arial, sans-serif;
  color: var(--text-light);
  min-height: 100vh;
  transition: var(--transition);
}

/* Container */
.course-container {
  width: 100%;
  max-width: 1400px;
  margin: 0 auto;
  background: var(--bg);
  border-radius: var(--border-radius);
  padding: 40px;
  box-shadow: var(--shadow);
  animation: fadeIn 0.6s ease-in-out;
  position: relative;
  overflow: hidden;
  border: 1px solid rgba(0,0,0,0.03);
}

.course-container::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 5px;
  background: linear-gradient(90deg, var(--primary) 0%, var(--primary-dark) 100%);
  border-radius: var(--border-radius) var(--border-radius) 0 0;
}

/* Header Section */
.course-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 40px;
  flex-wrap: wrap;
  gap: 25px;
}

.header-content h1 {
  font-size: 38px;
  font-weight: 800;
  color: var(--text-light);
  margin: 0 0 10px 0;
  position: relative;
  letter-spacing: -0.5px;
  background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.header-content .subtitle {
  color: var(--text-muted);
  font-size: 17px;
  margin: 0;
  font-weight: 500;
  line-height: 1.5;
}

.header-stats {
  display: flex;
  align-items: center;
  gap: 25px;
}

.stat-card {
  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
  padding: 20px 25px;
  border-radius: 14px;
  text-align: center;
  border: 1px solid rgba(0,0,0,0.05);
  box-shadow: var(--shadow);
  transition: var(--transition);
  position: relative;
  overflow: hidden;
}

.stat-card::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--primary) 0%, var(--primary-dark) 100%);
}

.stat-card:hover {
  transform: translateY(-5px);
  box-shadow: var(--shadow-lg);
}

.stat-number {
  display: block;
  font-size: 32px;
  font-weight: 800;
  color: var(--primary);
  line-height: 1;
  transition: var(--transition);
}

.stat-label {
  font-size: 14px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.8px;
  font-weight: 700;
  margin-top: 8px;
}

/* Add Course Button */
.add-btn {
  display: inline-flex;
  align-items: center;
  gap: 12px;
  padding: 16px 28px;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: var(--bg);
  font-weight: 700;
  border-radius: 12px;
  text-decoration: none;
  transition: var(--transition);
  white-space: nowrap;
  box-shadow: 0 6px 15px rgba(89, 50, 234, 0.2);
  letter-spacing: 0.3px;
  font-size: 15px;
  position: relative;
  overflow: hidden;
}

.add-btn::before {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  transition: var(--transition);
}

.add-btn:hover::before {
  left: 100%;
}

.add-btn:hover {
  background: linear-gradient(135deg, var(--primary-dark), var(--primary));
  transform: translateY(-3px);
  box-shadow: 0 8px 20px rgba(89, 50, 234, 0.3);
  color: var(--bg);
}

/* Toolbar */
.course-toolbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 35px;
  flex-wrap: wrap;
  gap: 20px;
  padding: 25px;
  background: var(--bg-light);
  border: 1px solid #E5E7EB;
  border-radius: 14px;
  backdrop-filter: blur(10px);
}

.search-box {
  position: relative;
  flex: 1;
  max-width: 500px;
}

.search-input {
  width: 100%;
  padding: 16px 50px 16px 22px;
  border: 1.5px solid #E5E7EB;
  border-radius: 12px;
  font-size: 15px;
  transition: var(--transition);
  background: var(--bg);
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.04);
  font-weight: 500;
}

.search-input:focus,
.filter-select:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 4px rgba(89, 50, 234, 0.15);
  outline: none;
}

.search-icon {
  position: absolute;
  right: 20px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--text-muted);
  font-size: 18px;
}

.filter-options {
  display: flex;
  gap: 15px;
}

.filter-select {
  padding: 15px 20px;
  border: 1.5px solid #E5E7EB;
  border-radius: 12px;
  font-size: 14px;
  background: var(--bg);
  cursor: pointer;
  transition: var(--transition);
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.04);
  font-weight: 500;
}

/* Grid Layout */
.course-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
  gap: 30px;
}

/* Course Card */
.course-card {
  background: var(--bg);
  border: 1.5px solid #E5E7EB;
  border-radius: 16px;
  padding: 30px;
  transition: var(--transition);
  position: relative;
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.05);
  animation: slideIn 0.5s ease-out forwards;
  opacity: 0;
}

.course-card::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 5px;
  background: linear-gradient(90deg, var(--primary), var(--primary-dark));
  transform: scaleX(0);
  transition: var(--transition);
  border-radius: 16px 16px 0 0;
}

.course-card:hover {
  transform: translateY(-8px);
  border-color: var(--primary-light);
  box-shadow: var(--shadow-lg);
}

.course-card:hover::before {
  transform: scaleX(1);
}

/* Course Title */
.course-card strong {
  font-size: 22px;
  color: var(--text-light);
  display: block;
  margin-bottom: 18px;
  letter-spacing: 0.3px;
  font-weight: 700;
  line-height: 1.4;
  position: relative;
  padding-bottom: 12px;
}

.course-card strong::after {
  content: "";
  position: absolute;
  bottom: 0;
  left: 0;
  width: 40px;
  height: 3px;
  background: linear-gradient(90deg, var(--primary), var(--primary-dark));
  border-radius: 2px;
}

.course-desc {
  overflow: hidden;
  transition: max-height 0.4s ease;
  color: var(--text-muted);
  line-height: 1.6;
  margin-bottom: 10px;
}

.course-desc.truncated {
  max-height: 120px;
}

.course-desc.expanded {
  max-height: 1000px;
}

/* Read More Link */
.read-more {
  color: var(--primary);
  font-weight: 600;
  cursor: pointer;
  text-decoration: none;
  margin-top: 8px;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  transition: var(--transition);
  font-size: 14px;
}

.read-more:hover {
  color: var(--primary-dark);
  gap: 8px;
}

/* Action Links */
.actions {
  display: flex;
  gap: 12px;
  margin-top: auto;
  padding-top: 20px;
}

.actions a {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  padding: 14px 20px;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: var(--bg);
  border-radius: 10px;
  text-decoration: none;
  font-weight: 600;
  transition: var(--transition);
  flex: 1;
  justify-content: center;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
  position: relative;
  overflow: hidden;
}

.actions a::before {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  transition: var(--transition);
}

.actions a:hover::before {
  left: 100%;
}

.actions a:hover {
  background: linear-gradient(135deg, var(--primary-dark), var(--primary));
  transform: translateY(-2px);
  box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
  color: var(--bg);
}

.actions a:first-child {
  background: linear-gradient(135deg, var(--text-light) 0%, #333 100%);
}

.actions a:first-child:hover {
  background: linear-gradient(135deg, #333 0%, var(--text-light) 100%);
}

.actions a.delete-btn {
  background: linear-gradient(135deg, #e11d48, #b91c1c);
}

.actions a.delete-btn:hover {
  background: linear-gradient(135deg, #b91c1c, #e11d48);
}

/* Empty State */
.course-grid:has(.empty-state) {
  display: block;
}

.empty-state {
  text-align: center;
  padding: 90px 30px;
  color: var(--text-muted);
  background: var(--bg-light);
  border-radius: 16px;
  border: 2px dashed #E5E7EB;
  transition: var(--transition);
}

.empty-state:hover {
  border-color: var(--primary-light);
  transform: translateY(-5px);
}

.empty-icon {
  font-size: 70px;
  margin-bottom: 28px;
  display: block;
  opacity: 0.7;
  transition: var(--transition);
}

.empty-state:hover .empty-icon {
  transform: scale(1.1);
  opacity: 0.9;
}

.empty-state h3 {
  font-size: 26px;
  margin-bottom: 15px;
  color: var(--text-light);
  font-weight: 700;
}

.empty-state p {
  font-size: 16px;
  margin-bottom: 32px;
  max-width: 450px;
  margin-left: auto;
  margin-right: auto;
  line-height: 1.7;
}

/* Custom Delete Modal */
.delete-modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(5px);
  z-index: 1000;
  justify-content: center;
  align-items: center;
}

.delete-modal-content {
  background: var(--bg);
  padding: 35px;
  border-radius: 16px;
  box-shadow: var(--shadow-lg);
  max-width: 450px;
  width: 90%;
  text-align: center;
  animation: modalSlideIn 0.3s ease-out;
  border: 1px solid rgba(0,0,0,0.05);
  position: relative;
}

.delete-modal-content::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 5px;
  background: linear-gradient(90deg, #e11d48, #b91c1c);
  border-radius: 16px 16px 0 0;
}

.delete-modal-icon {
  font-size: 52px;
  margin-bottom: 22px;
  display: block;
}

.delete-modal h3 {
  font-size: 22px;
  margin-bottom: 12px;
  color: var(--text-light);
  font-weight: 700;
}

.delete-modal p {
  color: var(--text-muted);
  margin-bottom: 28px;
  line-height: 1.6;
  font-size: 15px;
}

.delete-modal-actions {
  display: flex;
  gap: 15px;
  justify-content: center;
}

.modal-btn {
  padding: 12px 28px;
  border: none;
  border-radius: 8px;
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition);
  flex: 1;
  font-size: 14px;
  position: relative;
  overflow: hidden;
}

.modal-btn::before {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  transition: var(--transition);
}

.modal-btn:hover::before {
  left: 100%;
}

.modal-btn.cancel {
  background: var(--bg-light);
  color: var(--text-light);
  border: 1.5px solid #E5E7EB;
}

.modal-btn.cancel:hover {
  background: #e9ecef;
  transform: translateY(-2px);
}

.modal-btn.confirm-delete {
  background: linear-gradient(135deg, #e11d48, #b91c1c);
  color: var(--bg);
}

.modal-btn.confirm-delete:hover {
  background: linear-gradient(135deg, #b91c1c, #e11d48);
  transform: translateY(-2px);
}

/* Enhanced Animations */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(25px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes slideIn {
  from { opacity: 0; transform: translateX(-25px); }
  to { opacity: 1; transform: translateX(0); }
}

@keyframes modalSlideIn {
  from { opacity: 0; transform: translateY(-35px) scale(0.9); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}

@keyframes slideOut {
  from { opacity: 1; transform: translateY(0); }
  to { opacity: 0; transform: translateY(-25px); }
}

@keyframes slideInRight {
  from { opacity: 0; transform: translateX(30px); }
  to { opacity: 1; transform: translateX(0); }
}

@keyframes slideOutRight {
  from { opacity: 1; transform: translateX(0); }
  to { opacity: 0; transform: translateX(30px); }
}

/* Card animation delays */
.course-card:nth-child(1) { animation-delay: 0.1s; }
.course-card:nth-child(2) { animation-delay: 0.15s; }
.course-card:nth-child(3) { animation-delay: 0.2s; }
.course-card:nth-child(4) { animation-delay: 0.25s; }
.course-card:nth-child(5) { animation-delay: 0.3s; }
.course-card:nth-child(6) { animation-delay: 0.35s; }

/* Responsive Design */
@media (max-width: 1200px) {
  .course-grid {
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  }
}

@media (max-width: 992px) {
  .course-page {
    margin-left: 0;
    padding: 25px;
  }
}

@media (max-width: 768px) {
  .course-header {
    flex-direction: column;
    align-items: flex-start;
  }
  
  .header-content h1 {
    font-size: 34px;
  }
  
  .header-stats {
    width: 100%;
    justify-content: space-between;
  }
  
  .course-toolbar {
    flex-direction: column;
    align-items: stretch;
  }
  
  .search-box {
    max-width: 100%;
  }
  
  .course-grid {
    grid-template-columns: 1fr;
    gap: 25px;
  }
  
  .course-container {
    padding: 30px;
  }
  
  .filter-options {
    width: 100%;
    justify-content: space-between;
  }
  
  .filter-select {
    flex: 1;
  }
  
  .delete-modal-actions {
    flex-direction: column;
  }
}

@media (max-width: 480px) {
  .course-page {
    padding: 20px;
  }
  
  .course-container {
    padding: 25px;
  }
  
  .actions {
    flex-direction: column;
  }
  
  .actions a {
    flex: none;
  }
  
  .header-stats {
    flex-direction: column;
    gap: 18px;
  }
  
  .stat-card {
    width: 100%;
  }
  
  .course-header {
    gap: 20px;
  }
}
</style>

<div class="course-page">
  <div class="course-container">
    <!-- Enhanced Header Section -->
    <div class="course-header">
      <div class="header-content">
        <h1>Course Management</h1>
        <p class="subtitle">Design, organize, and manage your educational programs</p>
      </div>
      
      <div class="header-stats">
        <div class="stat-card">
          <span class="stat-number">{{ courses|length }}</span>
          <span class="stat-label">Total Courses</span>
        </div>
        <a href="{% url 'course_create' %}" class="add-btn">
          <span>‚ûï</span>
          <span>Create New Course</span>
        </a>
      </div>
    </div>

    <!-- Enhanced Toolbar with Search and Filters -->
    <div class="course-toolbar">
      <div class="search-box">
        <input type="text" placeholder="Search courses by name or description..." class="search-input">
        <span class="search-icon">üîç</span>
      </div>
    </div>

    <!-- Enhanced Courses Grid -->
    <div class="course-grid">
      {% for course in courses %}
        <div class="course-card" id="course-{{ course.pk }}">
          <strong>{{ course.name }}</strong>
          <p class="course-desc" id="desc-{{ course.pk }}">{{ course.description }}</p>
          <a href="javascript:void(0)" class="read-more" data-id="{{ course.pk }}">
            <span>Read More</span>
            <span>‚Üí</span>
          </a>

          <div class="actions">
            <a href="{% url 'course_update' course.pk %}">
              <span>‚úèÔ∏è</span>
              <span>Edit Course</span>
            </a>
            <a href="javascript:void(0)" class="delete-btn" data-id="{{ course.pk }}" data-name="{{ course.name }}">
              <span>üóëÔ∏è</span>
              <span>Delete</span>
            </a>
          </div>
        </div>
      {% empty %}
        <div class="empty-state">
          <span class="empty-icon">üìö</span>
          <h3>No courses found</h3>
          <p>Start building your educational curriculum by creating your first course. Design engaging content and organize your materials effectively.</p>
          <a href="{% url 'course_create' %}" class="add-btn">Create Your First Course</a>
        </div>
      {% endfor %}
    </div>
  </div>
</div>

<!-- Custom Delete Confirmation Modal -->
<div class="delete-modal" id="deleteModal">
  <div class="delete-modal-content">
    <span class="delete-modal-icon">‚ö†Ô∏è</span>
    <h3>Delete Course</h3>
    <p id="deleteModalText">Are you sure you want to delete this course? This action cannot be undone.</p>
    <div class="delete-modal-actions">
      <button class="modal-btn cancel" id="cancelDelete">Cancel</button>
      <button class="modal-btn confirm-delete" id="confirmDelete">Delete Course</button>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const deleteButtons = document.querySelectorAll('.delete-btn');
  const deleteModal = document.getElementById('deleteModal');
  const cancelDeleteBtn = document.getElementById('cancelDelete');
  const confirmDeleteBtn = document.getElementById('confirmDelete');
  const deleteModalText = document.getElementById('deleteModalText');
  let courseToDelete = null;

  // Function to get CSRF token
  function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
      const cookies = document.cookie.split(';');
      for (let cookie of cookies) {
        cookie = cookie.trim();
        if (cookie.startsWith(name + '=')) {
          cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
          break;
        }
      }
    }
    return cookieValue;
  }
  const csrftoken = getCookie('csrftoken');

  // Delete functionality with custom modal
  deleteButtons.forEach(button => {
    button.addEventListener('click', () => {
      courseToDelete = button.dataset.id;
      const courseName = button.dataset.name;
      
      deleteModalText.textContent = `Are you sure you want to delete "${courseName}"? This action cannot be undone.`;
      deleteModal.style.display = 'flex';
    });
  });

  // Cancel delete
  cancelDeleteBtn.addEventListener('click', () => {
    deleteModal.style.display = 'none';
    courseToDelete = null;
  });

  // Confirm delete
  confirmDeleteBtn.addEventListener('click', () => {
    if (courseToDelete) {
      fetch(`/courses/delete/${courseToDelete}/`, {
        method: 'POST',
        headers: {
          'X-CSRFToken': csrftoken,
          'X-Requested-With': 'XMLHttpRequest'
        }
      })
      .then(response => response.json())
      .then(data => {
        if (data.status === 'success') {
          const card = document.getElementById(`course-${courseToDelete}`);
          if (card) {
            card.style.animation = 'slideOut 0.3s ease forwards';
            setTimeout(() => {
              card.remove();
              
              // Update course count
              const statNumber = document.querySelector('.stat-number');
              if (statNumber) {
                const currentCount = parseInt(statNumber.textContent);
                statNumber.textContent = currentCount - 1;
                
                // Add count animation
                statNumber.style.transform = 'scale(1.2)';
                setTimeout(() => {
                  statNumber.style.transform = 'scale(1)';
                }, 300);
              }
              
              // Show success message
              showNotification('Course deleted successfully!', 'success');
              
              // Show empty state if no courses left
              if (document.querySelectorAll('.course-card').length === 0) {
                location.reload();
              }
            }, 300);
          }
        } else {
          showNotification('Failed to delete the course.', 'error');
        }
      })
      .catch(err => {
        console.error('Error:', err);
        showNotification('An error occurred while deleting the course.', 'error');
      })
      .finally(() => {
        deleteModal.style.display = 'none';
        courseToDelete = null;
      });
    }
  });

  // Close modal when clicking outside
  deleteModal.addEventListener('click', (e) => {
    if (e.target === deleteModal) {
      deleteModal.style.display = 'none';
      courseToDelete = null;
    }
  });

  // Enhanced search functionality
  const searchInput = document.querySelector('.search-input');
  if (searchInput) {
    let searchTimeout;
    
    searchInput.addEventListener('input', (e) => {
      clearTimeout(searchTimeout);
      
      // Add slight delay for better performance
      searchTimeout = setTimeout(() => {
        const searchTerm = e.target.value.toLowerCase().trim();
        const courseCards = document.querySelectorAll('.course-card');
        let visibleCount = 0;
        
        courseCards.forEach(card => {
          const courseName = card.querySelector('strong').textContent.toLowerCase();
          const courseDesc = card.querySelector('.course-desc').textContent.toLowerCase();
          
          if (courseName.includes(searchTerm) || courseDesc.includes(searchTerm)) {
            card.style.display = 'flex';
            visibleCount++;
          } else {
            card.style.display = 'none';
          }
        });
        
        // Update visible count in UI if needed
        console.log(`${visibleCount} courses match your search`);
      }, 300);
    });
  }
  
  // Add hover effect to stat card
  const statCard = document.querySelector('.stat-card');
  if (statCard) {
    statCard.addEventListener('mouseenter', () => {
      statCard.style.transform = 'translateY(-5px)';
    });
    
    statCard.addEventListener('mouseleave', () => {
      statCard.style.transform = 'translateY(0)';
    });
  }

  // Notification function
  function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.textContent = message;
    notification.style.cssText = `
      position: fixed;
      top: 80px;
      right: 25px;
      padding: 16px 24px;
      border-radius: 10px;
      color: #fff;
      font-weight: 600;
      z-index: 1001;
      animation: slideInRight 0.3s ease;
      box-shadow: var(--shadow-lg);
      ${type === 'success' ? 'background: linear-gradient(135deg, #28a745, #20c997);' : 'background: linear-gradient(135deg, #e11d48, #b91c1c);'}
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
      notification.style.animation = 'slideOutRight 0.3s ease forwards';
      setTimeout(() => notification.remove(), 300);
    }, 3000);
  }
});

// Read More functionality
document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('.course-desc').forEach(p => {
    const words = p.textContent.split(" ");
    p.dataset.full = p.textContent;

    const link = document.querySelector(`.read-more[data-id='${p.id.split('-')[1]}']`);

    if(words.length > 50){
      p.dataset.truncated = words.slice(0,50).join(" ") + " ...";
      p.textContent = p.dataset.truncated;
      p.classList.add('truncated'); // only add truncated class if text is long
      if(link) link.style.display = 'inline-flex';
    } else {
      if(link) link.style.display = 'none'; // hide read more for short text
    }
  });

  // Read More / Read Less
  document.querySelectorAll('.read-more').forEach(link => {
    link.addEventListener('click', () => {
      const id = link.dataset.id;
      const desc = document.getElementById(`desc-${id}`);

      if(link.textContent.includes("Read More")) {
        desc.textContent = desc.dataset.full;
        desc.classList.remove('truncated'); // expand
        link.innerHTML = '<span>Read Less</span> <span>‚Üë</span>';
      } else {
        desc.textContent = desc.dataset.truncated;
        desc.classList.add('truncated'); // collapse
        link.innerHTML = '<span>Read More</span> <span>‚Üí</span>';
      }
    });
  });
});
</script>

{% endblock %}