{% extends "login_base.html" %}
{% block content %}
{% load static %}

<div class="main-content">

<!-- ===================== TITLE + FILTER PANEL ===================== -->
<div class="tw-panel tw-panel-top">

    <div class="tw-header-row">
        <h2 class="tw-title">All Intern Project Submissions</h2>

        <form method="get" class="tw-filter-inline">
            <select name="batch" class="tw-select" required>
                <option value="">-- Select Batch --</option>

                {% for b in batches %}
                <option value="{{ b.id }}" {% if selected_batch == b.id|stringformat:"s" %}selected{% endif %}>
                    {{ b.name }}
                </option>
                {% endfor %}
            </select>

            <button class="tw-btn tw-btn-primary">Search</button>

            {% if selected_batch %}
            <a href="{% url 'admin_intern_projects_overview' %}" class="tw-btn tw-btn-secondary">Clear</a>
            {% endif %}
        </form>
    </div>

</div>

<!-- ===================== TABLE SECTION ===================== -->

<div class="tw-panel tw-panel-table">
    <div class="table-responsive">
        <table class="tw-table colorful-table">
            <thead>
                <tr>
                    <th>Intern</th>
                    <th>Batch</th>
                    <th>Project Title</th>
                    <th>Status</th>
                    <th>Score</th>
                    <th>Submitted</th>
                    <th>View</th>
                </tr>
            </thead>

            <tbody>
            {% if projects %}
                {% for p in projects %}
                <tr>

                    <td>
                        <div class="tw-user">
                            <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png" class="tw-avatar-img">
                            <div>
                                <div class="tw-user-name">{{ p.intern.user.get_full_name }}</div>
                                <div class="tw-user-id">ID: {{ p.intern.unique_id }}</div>
                            </div>
                        </div>
                    </td>

                    <td>{{ p.intern.batch.name }}</td>
                    <td>{{ p.project_title }}</td>

                    <td>
                        <span class="tw-status tw-{{ p.status|lower }}">{{ p.status }}</span>
                    </td>

                    <td>{% if p.score %}{{ p.score }}{% else %}-{% endif %}</td>
                    <td>{{ p.submitted_at|date:"d M Y H:i" }}</td>

                    <td>
                        <a href="{% url 'intern_project_detail' p.pk %}" class="tw-btn-view">View</a>
                    </td>
                </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="8" class="tw-empty">
                        <div class="tw-empty-box">
                            <img src="{% static 'images/emty.png' %}" class="tw-empty-img" height="230px" width="230px">
                            <p>
                                {% if selected_batch %}
                                    No projects found for this batch.
                                {% else %}
                                    Please select a batch to view intern projects.
                                {% endif %}
                            </p>
                        </div>
                    </td>
                </tr>
            {% endif %}
            </tbody>
        </table>
    </div>
</div>

</div>


<!-- ===================== SAME CSS FROM PREVIOUS DESIGN ===================== -->
<style>
:root {
    --tw-primary: #5932EA;
    --tw-primary-dark: #324fc3;
    --tw-border: #e5e7eb;
    --tw-muted: #6b7280;
    --tw-text: #1f2937;
    --tw-bg: #ffffff;
}

.tw-panel {
    background: var(--tw-bg);
    border: 1px solid #e0e0e0;
    border-radius: 14px;
    padding: 22px;
    margin-bottom: 25px;
}
.table-responsive {
    width: 100%;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
}

/* ---------- ROW HEADER ---------- */
.tw-header-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.tw-filter-inline {
    display: flex;
    gap: 10px;
}

.tw-title {
    font-size: 1.7rem;
    font-weight: 800;
    color: var(--tw-primary);
}

.tw-select {
    padding: 10px 12px;
    border: 1px solid var(--tw-border);
    border-radius: 8px;
    min-width: 200px;
}

/* Buttons */
.tw-btn {
    padding: 10px 16px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    border: none;
    text-decoration: none;
}
.tw-btn-primary { background: var(--tw-primary); color: white; }
.tw-btn-primary:hover { background: var(--tw-primary-dark); }

.tw-btn-secondary { background: #ddd; color: #333; }

/* ---------- Colorful Table ---------- */
.tw-table {
    width: 100%;
    border-collapse: collapse;
}

.colorful-table thead tr {
    background: linear-gradient(90deg, #3b5bdb, #7048e8);
    color: white;
}
.colorful-table th { padding: 14px; font-size: 0.9rem; text-transform: uppercase; }

.colorful-table td {
    padding: 16px;
    border-bottom: 1px solid var(--tw-border);
}

.colorful-table tbody tr:nth-child(odd) {
    background: #f5f7ff;
}
.colorful-table tbody tr:nth-child(even) {
    background: #ffffff;
}
.colorful-table tbody tr:hover {
    background: #edf0ff;
}

/* ---------- Avatar ---------- */
.tw-user {
    display: flex;
    align-items: center;
    gap: 12px;
}
.tw-avatar-img {
    width: 38px;
    height: 38px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid var(--tw-primary);
}

.tw-user-name { font-weight: 600; }
.tw-user-id { font-size: 0.8rem; color: var(--tw-muted); }

/* Status */
.tw-status {
    padding: 6px 10px;
    border-radius: 6px;
    color: white;
    font-size: 0.8rem;
    text-transform: capitalize;
    font-weight: 600;
}
.tw-viewed { background: #16a34a; }
.tw-pending { background: #f59e0b; }
.tw-rejected { background: #dc2626; }

/* View Button */
.tw-btn-view {
    background: linear-gradient(90deg, #3b5bdb, #7048e8);
    color: white;
    padding: 8px 14px;
    border-radius: 8px;
    text-decoration: none;
    font-weight: 600;
    display: inline-block;
    border: none;
    transition: 0.25s ease;
    font-size: 12px;
}
.tw-btn-view:hover {
    background: linear-gradient(90deg, #324fc3, #5a32d3);
    transform: translateY(-2px);
}
.tw-btn-view:hover { background: var(--tw-primary-dark); }

.tw-empty {
    text-align: center;
    padding: 25px;
    color: var(--tw-muted);
}


/* ===================== RESPONSIVE DESIGN ===================== */

/* Tablet */
@media (max-width: 992px) {
    .tw-header-row {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
    }

    .tw-filter-inline {
        width: 100%;
        flex-wrap: wrap;
    }

    .tw-select {
        width: 100%;
    }
}

/* Mobile */
@media (max-width: 768px) {
    .tw-title {
        font-size: 1.4rem;
    }

    .tw-filter-inline {
        flex-direction: column;
        align-items: stretch;
    }

    .tw-filter-inline .tw-btn,
    .tw-filter-inline .tw-btn-secondary,
    .tw-filter-inline .tw-btn-primary {
        width: 100%;
        text-align: center;
    }

    .tw-table tbody tr td {
        padding: 12px;
    }

    .tw-user {
        flex-direction: row;
    }

    .tw-avatar-img {
        width: 32px;
        height: 32px;
    }
}

/* Small Mobile */</style>

{% endblock %}
